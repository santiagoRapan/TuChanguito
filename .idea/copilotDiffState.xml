<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/tuchanguito/MainActivity.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/tuchanguito/MainActivity.kt" />
              <option name="originalContent" value="package com.example.tuchanguito&#10;&#10;import android.os.Bundle&#10;import androidx.activity.ComponentActivity&#10;import androidx.activity.compose.setContent&#10;import androidx.activity.enableEdgeToEdge&#10;import androidx.compose.material3.Icon&#10;import androidx.compose.material3.Text&#10;import androidx.compose.material3.adaptive.navigationsuite.NavigationSuiteScaffold&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.runtime.getValue&#10;import androidx.compose.runtime.mutableStateOf&#10;import androidx.compose.runtime.remember&#10;import androidx.compose.runtime.saveable.rememberSaveable&#10;import androidx.compose.runtime.setValue&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.tooling.preview.Preview&#10;import androidx.compose.ui.tooling.preview.PreviewScreenSizes&#10;import androidx.navigation.compose.rememberNavController&#10;import com.example.tuchanguito.ui.navigation.AppNavGraph&#10;import com.example.tuchanguito.ui.navigation.Routes&#10;import com.example.tuchanguito.ui.navigation.TopLevelDest&#10;import com.example.tuchanguito.ui.theme.TuChanguitoTheme&#10;import com.example.tuchanguito.data.PreferencesManager&#10;import androidx.compose.runtime.collectAsState&#10;import androidx.compose.foundation.isSystemInDarkTheme&#10;import androidx.compose.runtime.LaunchedEffect&#10;import com.example.tuchanguito.ui.theme.ButtonBlue&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.core.view.WindowCompat&#10;import android.app.Activity&#10;import androidx.compose.runtime.SideEffect&#10;import androidx.compose.ui.platform.LocalContext&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.layout.Box&#10;import androidx.compose.foundation.layout.Column&#10;import androidx.compose.foundation.layout.Spacer&#10;import androidx.compose.foundation.layout.height&#10;import androidx.compose.foundation.layout.fillMaxWidth&#10;import androidx.compose.foundation.layout.fillMaxSize&#10;import androidx.compose.foundation.layout.windowInsetsTopHeight&#10;import androidx.compose.foundation.layout.WindowInsets&#10;import androidx.compose.foundation.layout.statusBars&#10;import androidx.compose.ui.platform.LocalConfiguration&#10;import android.content.res.Configuration&#10;import androidx.compose.foundation.rememberScrollState&#10;import androidx.compose.foundation.verticalScroll&#10;import androidx.compose.ui.unit.dp&#10;&#10;class MainActivity : ComponentActivity() {&#10;    override fun onCreate(savedInstanceState: Bundle?) {&#10;        super.onCreate(savedInstanceState)&#10;        enableEdgeToEdge()&#10;        // Ensure content does not draw behind system bars by default, avoids flicker on rotation&#10;        WindowCompat.setDecorFitsSystemWindows(window, true)&#10;        setContent {&#10;            val prefs = PreferencesManager(this)&#10;            val theme by prefs.theme.collectAsState(initial = &quot;system&quot;)&#10;            val isDark = when(theme){&quot;dark&quot;-&gt;true;&quot;light&quot;-&gt;false;else-&gt;isSystemInDarkTheme()}&#10;            TuChanguitoTheme(darkTheme = isDark) {&#10;                 StatusBarForTheme(isDark)&#10;                 val configuration = LocalConfiguration.current&#10;                 val isLandscape = configuration.orientation == Configuration.ORIENTATION_LANDSCAPE&#10;                 Column {&#10;                    if (!isDark) {&#10;                        // Pintar SIEMPRE la franja del alto de la status bar en azul en tema claro&#10;                        Spacer(&#10;                            modifier = Modifier&#10;                                .fillMaxWidth()&#10;                                .background(Color(0xFF1F6FA3))&#10;                                .windowInsetsTopHeight(WindowInsets.statusBars)&#10;                        )&#10;                    }&#10;                    if (isLandscape &amp;&amp; !isDark) {&#10;                        // Fallback mínimo si los insets reportan 0 en horizontal&#10;                        Spacer(modifier = Modifier.fillMaxWidth().height(16.dp).background(Color(0xFF1F6FA3)))&#10;                    }&#10;                    TuChanguitoApp()&#10;                 }&#10;             }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun StatusBarForTheme(isDark: Boolean) {&#10;    val activity = LocalContext.current as Activity&#10;    SideEffect {&#10;        val window = activity.window&#10;        val controller = WindowCompat.getInsetsController(window, window.decorView)&#10;        if (!isDark) {&#10;            // En modo claro: status bar azul e íconos blancos&#10;            window.statusBarColor = android.graphics.Color.parseColor(&quot;#1F6FA3&quot;)&#10;            controller.isAppearanceLightStatusBars = false&#10;        } else {&#10;            // En modo oscuro: mantener íconos claros&#10;            controller.isAppearanceLightStatusBars = false // íconos claros sobre fondo oscuro&#10;        }&#10;    }&#10;}&#10;&#10;@PreviewScreenSizes&#10;@Composable&#10;fun TuChanguitoApp(modifier: Modifier = Modifier) {&#10;    val context = androidx.compose.ui.platform.LocalContext.current&#10;    val prefs = remember { PreferencesManager(context) }&#10;    val authToken by prefs.authToken.collectAsState(initial = null)&#10;&#10;    val navController = rememberNavController()&#10;    var currentDestination by rememberSaveable { mutableStateOf&lt;TopLevelDest?&gt;(null) }&#10;    val configuration = LocalConfiguration.current&#10;    val isLandscape = configuration.orientation == Configuration.ORIENTATION_LANDSCAPE&#10;    val scrollState = rememberScrollState()&#10;&#10;&#10;    if (authToken.isNullOrEmpty()) {&#10;        // Not signed in: show auth flow without bottom navigation&#10;        val contentMod = if (isLandscape) Modifier.fillMaxSize().verticalScroll(scrollState) else Modifier.fillMaxSize()&#10;        Box(modifier = contentMod) {&#10;            AppNavGraph(&#10;                navController = navController,&#10;                startDestination = Routes.AUTH,&#10;                modifier = Modifier.fillMaxSize()&#10;            )&#10;        }&#10;    } else {&#10;        // Signed in: show bottom navigation and main graph&#10;        NavigationSuiteScaffold(&#10;            navigationSuiteItems = {&#10;                listOf(TopLevelDest.Home, TopLevelDest.Lists, TopLevelDest.Pantry, TopLevelDest.Profile).forEach { dest -&gt;&#10;                    item(&#10;                        icon = { Icon(dest.icon, contentDescription = dest.label, tint = if (currentDestination?.route == dest.route) ButtonBlue else Color.Unspecified) },&#10;                        label = { Text(dest.label, color = if (currentDestination?.route == dest.route) ButtonBlue else Color.Unspecified) },&#10;                        selected = currentDestination?.route == dest.route,&#10;                        onClick = {&#10;                            currentDestination = dest&#10;                            navController.navigate(dest.route) { launchSingleTop = true }&#10;                        }&#10;                    )&#10;                }&#10;            }&#10;        ) {&#10;            val contentMod = if (isLandscape) Modifier.fillMaxSize().verticalScroll(scrollState) else Modifier.fillMaxSize()&#10;            Box(modifier = contentMod) {&#10;                AppNavGraph(&#10;                    navController = navController,&#10;                    startDestination = TopLevelDest.Home.route,&#10;                    modifier = Modifier.fillMaxSize()&#10;                )&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Preview(showBackground = true)&#10;@Composable&#10;fun GreetingPreview() {&#10;    TuChanguitoTheme {&#10;        TuChanguitoApp()&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.example.tuchanguito&#10;&#10;import android.os.Bundle&#10;import androidx.activity.ComponentActivity&#10;import androidx.activity.compose.setContent&#10;import androidx.activity.enableEdgeToEdge&#10;import androidx.compose.material3.Icon&#10;import androidx.compose.material3.Text&#10;import androidx.compose.material3.adaptive.navigationsuite.NavigationSuiteScaffold&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.runtime.getValue&#10;import androidx.compose.runtime.mutableStateOf&#10;import androidx.compose.runtime.remember&#10;import androidx.compose.runtime.saveable.rememberSaveable&#10;import androidx.compose.runtime.setValue&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.tooling.preview.Preview&#10;import androidx.compose.ui.tooling.preview.PreviewScreenSizes&#10;import androidx.navigation.compose.rememberNavController&#10;import com.example.tuchanguito.ui.navigation.AppNavGraph&#10;import com.example.tuchanguito.ui.navigation.Routes&#10;import com.example.tuchanguito.ui.navigation.TopLevelDest&#10;import com.example.tuchanguito.ui.theme.TuChanguitoTheme&#10;import com.example.tuchanguito.data.PreferencesManager&#10;import androidx.compose.runtime.collectAsState&#10;import androidx.compose.foundation.isSystemInDarkTheme&#10;import androidx.compose.runtime.LaunchedEffect&#10;import com.example.tuchanguito.ui.theme.ButtonBlue&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.core.view.WindowCompat&#10;import android.app.Activity&#10;import androidx.compose.runtime.SideEffect&#10;import androidx.compose.ui.platform.LocalContext&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.layout.Box&#10;import androidx.compose.foundation.layout.Column&#10;import androidx.compose.foundation.layout.Spacer&#10;import androidx.compose.foundation.layout.height&#10;import androidx.compose.foundation.layout.fillMaxWidth&#10;import androidx.compose.foundation.layout.fillMaxSize&#10;import androidx.compose.foundation.layout.windowInsetsTopHeight&#10;import androidx.compose.foundation.layout.WindowInsets&#10;import androidx.compose.foundation.layout.statusBars&#10;import androidx.compose.ui.platform.LocalConfiguration&#10;import android.content.res.Configuration&#10;import androidx.compose.foundation.rememberScrollState&#10;import androidx.compose.foundation.verticalScroll&#10;import androidx.compose.ui.unit.dp&#10;&#10;class MainActivity : ComponentActivity() {&#10;    override fun onCreate(savedInstanceState: Bundle?) {&#10;        super.onCreate(savedInstanceState)&#10;        enableEdgeToEdge()&#10;        // Ensure content does not draw behind system bars by default, avoids flicker on rotation&#10;        WindowCompat.setDecorFitsSystemWindows(window, true)&#10;        setContent {&#10;            val prefs = PreferencesManager(this)&#10;            val theme by prefs.theme.collectAsState(initial = &quot;system&quot;)&#10;            val isDark = when(theme){&quot;dark&quot;-&gt;true;&quot;light&quot;-&gt;false;else-&gt;isSystemInDarkTheme()}&#10;            TuChanguitoTheme(darkTheme = isDark) {&#10;                 StatusBarForTheme(isDark)&#10;                 val configuration = LocalConfiguration.current&#10;                 val isLandscape = configuration.orientation == Configuration.ORIENTATION_LANDSCAPE&#10;                 Column {&#10;                    if (!isDark) {&#10;                        // Pintar SIEMPRE la franja del alto de la status bar en azul en tema claro&#10;                        Spacer(&#10;                            modifier = Modifier&#10;                                .fillMaxWidth()&#10;                                .background(Color(0xFF1F6FA3))&#10;                                .windowInsetsTopHeight(WindowInsets.statusBars)&#10;                        )&#10;                    }&#10;                    if (isLandscape &amp;&amp; !isDark) {&#10;                        // Fallback mínimo si los insets reportan 0 en horizontal&#10;                        Spacer(modifier = Modifier.fillMaxWidth().height(16.dp).background(Color(0xFF1F6FA3)))&#10;                    }&#10;                    TuChanguitoApp()&#10;                 }&#10;             }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun StatusBarForTheme(isDark: Boolean) {&#10;    val activity = LocalContext.current as Activity&#10;    SideEffect {&#10;        val window = activity.window&#10;        val controller = WindowCompat.getInsetsController(window, window.decorView)&#10;        if (!isDark) {&#10;            // En modo claro: status bar azul e íconos blancos&#10;            window.statusBarColor = android.graphics.Color.parseColor(&quot;#1F6FA3&quot;)&#10;            controller.isAppearanceLightStatusBars = false&#10;        } else {&#10;            // En modo oscuro: mantener íconos claros&#10;            controller.isAppearanceLightStatusBars = false // íconos claros sobre fondo oscuro&#10;        }&#10;    }&#10;}&#10;&#10;@PreviewScreenSizes&#10;@Composable&#10;fun TuChanguitoApp(modifier: Modifier = Modifier) {&#10;    val context = androidx.compose.ui.platform.LocalContext.current&#10;    val prefs = remember { PreferencesManager(context) }&#10;    val authToken by prefs.authToken.collectAsState(initial = null)&#10;&#10;    val navController = rememberNavController()&#10;    var currentDestination by rememberSaveable { mutableStateOf&lt;TopLevelDest?&gt;(null) }&#10;    val configuration = LocalConfiguration.current&#10;    val isLandscape = configuration.orientation == Configuration.ORIENTATION_LANDSCAPE&#10;&#10;&#10;    if (authToken.isNullOrEmpty()) {&#10;        // Not signed in: show auth flow without bottom navigation&#10;        AppNavGraph(&#10;            navController = navController,&#10;            startDestination = Routes.AUTH,&#10;            modifier = Modifier.fillMaxSize()&#10;        )&#10;    } else {&#10;        // Signed in: show bottom navigation and main graph&#10;        NavigationSuiteScaffold(&#10;            navigationSuiteItems = {&#10;                listOf(TopLevelDest.Home, TopLevelDest.Lists, TopLevelDest.Pantry, TopLevelDest.Profile).forEach { dest -&gt;&#10;                    item(&#10;                        icon = { Icon(dest.icon, contentDescription = dest.label, tint = if (currentDestination?.route == dest.route) ButtonBlue else Color.Unspecified) },&#10;                        label = { Text(dest.label, color = if (currentDestination?.route == dest.route) ButtonBlue else Color.Unspecified) },&#10;                        selected = currentDestination?.route == dest.route,&#10;                        onClick = {&#10;                            currentDestination = dest&#10;                            navController.navigate(dest.route) { launchSingleTop = true }&#10;                        }&#10;                    )&#10;                }&#10;            }&#10;        ) {&#10;            AppNavGraph(&#10;                navController = navController,&#10;                startDestination = TopLevelDest.Home.route,&#10;                modifier = Modifier.fillMaxSize()&#10;            )&#10;        }&#10;    }&#10;}&#10;&#10;@Preview(showBackground = true)&#10;@Composable&#10;fun GreetingPreview() {&#10;    TuChanguitoTheme {&#10;        TuChanguitoApp()&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/tuchanguito/ui/screens/home/HomeScreen.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/tuchanguito/ui/screens/home/HomeScreen.kt" />
              <option name="originalContent" value="package com.example.tuchanguito.ui.screens.home&#10;&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.compose.ui.res.stringResource&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.unit.dp&#10;import com.example.tuchanguito.R&#10;import com.example.tuchanguito.data.AppRepository&#10;import com.example.tuchanguito.data.model.ListItem&#10;import com.example.tuchanguito.data.model.ShoppingList&#10;import com.example.tuchanguito.ui.theme.PrimaryTextBlue&#10;import com.example.tuchanguito.ui.theme.ButtonBlue&#10;import androidx.compose.foundation.layout.size&#10;import androidx.compose.foundation.layout.Box&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.Add&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun HomeScreen(&#10;    onOpenList: (Long) -&gt; Unit,&#10;    onNewProduct: () -&gt; Unit,&#10;    onConfigureCategories: () -&gt; Unit,&#10;) {&#10;    val context = androidx.compose.ui.platform.LocalContext.current&#10;    val repo = remember { AppRepository.get(context) }&#10;&#10;    val lists by repo.activeLists().collectAsState(initial = emptyList())&#10;    val active = lists.firstOrNull()&#10;    val items by if (active != null) {&#10;        repo.itemsForList(active.id).collectAsState(initial = emptyList())&#10;    } else remember { mutableStateOf(emptyList()) }&#10;&#10;    Scaffold(topBar = { TopAppBar(title = { Text(stringResource(id = R.string.app_name), color = PrimaryTextBlue) }) }) { padding -&gt;&#10;        Column(Modifier.fillMaxSize().padding(padding).padding(16.dp)) {&#10;            ActiveListCard(active, items, onOpenList)&#10;            Spacer(Modifier.height(16.dp))&#10;            Row(Modifier.fillMaxWidth(), horizontalArrangement = Arrangement.SpaceEvenly) {&#10;                QuickAction(&quot;Nueva lista&quot;) { onOpenList(newList()) }&#10;                QuickAction(&quot;Nuevo producto&quot;, onNewProduct)&#10;                QuickAction(&quot;Configurar categorias&quot;, onConfigureCategories)&#10;            }&#10;            Spacer(Modifier.height(16.dp))&#10;            Text(&quot;Bajo stock&quot;, style = MaterialTheme.typography.titleLarge)&#10;            // In a full implementation, list pantry items under stock threshold&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun ActiveListCard(active: ShoppingList?, items: List&lt;ListItem&gt;, onOpen: (Long) -&gt; Unit) {&#10;    val acquiredCount = items.count { it.acquired }&#10;    val progress = if (items.isEmpty()) 0f else acquiredCount.toFloat() / items.size.toFloat()&#10;    Surface(Modifier.fillMaxWidth(), shape = RoundedCornerShape(16.dp), color = ButtonBlue) {&#10;        Column(Modifier.padding(16.dp)) {&#10;            Text(active?.title ?: &quot;Supermercado - Hoy&quot;, color = Color.White, style = MaterialTheme.typography.headlineSmall, fontWeight = FontWeight.Bold)&#10;            Spacer(Modifier.height(8.dp))&#10;            LinearProgressIndicator(progress = { progress }, modifier = Modifier.fillMaxWidth().clip(RoundedCornerShape(8.dp)), color = Color.White, trackColor = Color(0xFF8ECBF5))&#10;            Spacer(Modifier.height(8.dp))&#10;            Row(Modifier.fillMaxWidth(), horizontalArrangement = Arrangement.SpaceBetween) {&#10;                Text(&quot;${items.size - acquiredCount} pendientes&quot;, color = Color.White)&#10;                Text(&quot;$${total(items)}&quot;, color = Color.White)&#10;            }&#10;            Spacer(Modifier.height(8.dp))&#10;            Button(onClick = { if (active != null) onOpen(active.id) }, colors = ButtonDefaults.buttonColors(containerColor = ButtonBlue, contentColor = Color.White)) { Text(&quot;Abrir&quot;) }&#10;        }&#10;    }&#10;}&#10;&#10;private fun total(items: List&lt;ListItem&gt;): Int = items.sumOf { it.quantity * 100 } // demo pricing&#10;&#10;@Composable&#10;private fun QuickAction(label: String, onClick: () -&gt; Unit) {&#10;    Surface(onClick = onClick, tonalElevation = 1.dp, shape = RoundedCornerShape(12.dp)) {&#10;        Column(Modifier.padding(16.dp), horizontalAlignment = Alignment.CenterHorizontally) {&#10;            Surface(&#10;                modifier = Modifier.size(52.dp).clip(RoundedCornerShape(26.dp)),&#10;                color = ButtonBlue,&#10;                contentColor = Color.White,&#10;                tonalElevation = 0.dp&#10;            ) {&#10;                Box(contentAlignment = Alignment.Center) {&#10;                    Icon(imageVector = Icons.Filled.Add, contentDescription = &quot;add&quot;, tint = Color.White)&#10;                }&#10;            }&#10;            Spacer(Modifier.height(8.dp))&#10;            Text(label, style = MaterialTheme.typography.bodyMedium)&#10;        }&#10;    }&#10;}&#10;&#10;private fun newList(): Long {&#10;     // Create a new list synchronously for demo with runBlocking in real use; here we fake an id 0 and trigger navigation afterwards&#10;     // For simplicity in Composables we avoid blocking; let Lists screen handle creation. Here we just return -1 to open Lists page&#10;     return -1&#10; }&#10;" />
              <option name="updatedContent" value="package com.example.tuchanguito.ui.screens.home&#10;&#10;import androidx.compose.foundation.background&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.graphics.Color&#10;import androidx.compose.ui.res.stringResource&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.unit.dp&#10;import com.example.tuchanguito.R&#10;import com.example.tuchanguito.data.AppRepository&#10;import com.example.tuchanguito.data.model.ListItem&#10;import com.example.tuchanguito.data.model.ShoppingList&#10;import com.example.tuchanguito.ui.theme.PrimaryTextBlue&#10;import com.example.tuchanguito.ui.theme.ButtonBlue&#10;import androidx.compose.foundation.layout.size&#10;import androidx.compose.foundation.layout.Box&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.Add&#10;import androidx.compose.ui.platform.LocalConfiguration&#10;import android.content.res.Configuration&#10;import androidx.compose.foundation.rememberScrollState&#10;import androidx.compose.foundation.verticalScroll&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun HomeScreen(&#10;    onOpenList: (Long) -&gt; Unit,&#10;    onNewProduct: () -&gt; Unit,&#10;    onConfigureCategories: () -&gt; Unit,&#10;) {&#10;    val context = androidx.compose.ui.platform.LocalContext.current&#10;    val repo = remember { AppRepository.get(context) }&#10;&#10;    val lists by repo.activeLists().collectAsState(initial = emptyList())&#10;    val active = lists.firstOrNull()&#10;    val items by if (active != null) {&#10;        repo.itemsForList(active.id).collectAsState(initial = emptyList())&#10;    } else remember { mutableStateOf(emptyList()) }&#10;&#10;    Scaffold(topBar = { TopAppBar(title = { Text(stringResource(id = R.string.app_name), color = PrimaryTextBlue) }) }) { padding -&gt;&#10;        val isLandscape = LocalConfiguration.current.orientation == Configuration.ORIENTATION_LANDSCAPE&#10;        val scrollMod = if (isLandscape) Modifier.verticalScroll(rememberScrollState()) else Modifier&#10;        Column(Modifier.fillMaxSize().then(scrollMod).padding(padding).padding(16.dp)) {&#10;            ActiveListCard(active, items, onOpenList)&#10;            Spacer(Modifier.height(16.dp))&#10;            Row(Modifier.fillMaxWidth(), horizontalArrangement = Arrangement.SpaceEvenly) {&#10;                QuickAction(&quot;Nueva lista&quot;) { onOpenList(newList()) }&#10;                QuickAction(&quot;Nuevo producto&quot;, onNewProduct)&#10;                QuickAction(&quot;Configurar categorias&quot;, onConfigureCategories)&#10;            }&#10;            Spacer(Modifier.height(16.dp))&#10;            Text(&quot;Bajo stock&quot;, style = MaterialTheme.typography.titleLarge)&#10;            // In a full implementation, list pantry items under stock threshold&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;private fun ActiveListCard(active: ShoppingList?, items: List&lt;ListItem&gt;, onOpen: (Long) -&gt; Unit) {&#10;    val acquiredCount = items.count { it.acquired }&#10;    val progress = if (items.isEmpty()) 0f else acquiredCount.toFloat() / items.size.toFloat()&#10;    Surface(Modifier.fillMaxWidth(), shape = RoundedCornerShape(16.dp), color = ButtonBlue) {&#10;        Column(Modifier.padding(16.dp)) {&#10;            Text(active?.title ?: &quot;Supermercado - Hoy&quot;, color = Color.White, style = MaterialTheme.typography.headlineSmall, fontWeight = FontWeight.Bold)&#10;            Spacer(Modifier.height(8.dp))&#10;            LinearProgressIndicator(progress = { progress }, modifier = Modifier.fillMaxWidth().clip(RoundedCornerShape(8.dp)), color = Color.White, trackColor = Color(0xFF8ECBF5))&#10;            Spacer(Modifier.height(8.dp))&#10;            Row(Modifier.fillMaxWidth(), horizontalArrangement = Arrangement.SpaceBetween) {&#10;                Text(&quot;${items.size - acquiredCount} pendientes&quot;, color = Color.White)&#10;                Text(&quot;$${total(items)}&quot;, color = Color.White)&#10;            }&#10;            Spacer(Modifier.height(8.dp))&#10;            Button(onClick = { if (active != null) onOpen(active.id) }, colors = ButtonDefaults.buttonColors(containerColor = ButtonBlue, contentColor = Color.White)) { Text(&quot;Abrir&quot;) }&#10;        }&#10;    }&#10;}&#10;&#10;private fun total(items: List&lt;ListItem&gt;): Int = items.sumOf { it.quantity * 100 } // demo pricing&#10;&#10;@Composable&#10;private fun QuickAction(label: String, onClick: () -&gt; Unit) {&#10;    Surface(onClick = onClick, tonalElevation = 1.dp, shape = RoundedCornerShape(12.dp)) {&#10;        Column(Modifier.padding(16.dp), horizontalAlignment = Alignment.CenterHorizontally) {&#10;            Surface(&#10;                modifier = Modifier.size(52.dp).clip(RoundedCornerShape(26.dp)),&#10;                color = ButtonBlue,&#10;                contentColor = Color.White,&#10;                tonalElevation = 0.dp&#10;            ) {&#10;                Box(contentAlignment = Alignment.Center) {&#10;                    Icon(imageVector = Icons.Filled.Add, contentDescription = &quot;add&quot;, tint = Color.White)&#10;                }&#10;            }&#10;            Spacer(Modifier.height(8.dp))&#10;            Text(label, style = MaterialTheme.typography.bodyMedium)&#10;        }&#10;    }&#10;}&#10;&#10;private fun newList(): Long {&#10;     // Create a new list synchronously for demo with runBlocking in real use; here we fake an id 0 and trigger navigation afterwards&#10;     // For simplicity in Composables we avoid blocking; let Lists screen handle creation. Here we just return -1 to open Lists page&#10;     return -1&#10; }" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/tuchanguito/ui/screens/lists/ListsScreen.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/tuchanguito/ui/screens/lists/ListsScreen.kt" />
              <option name="originalContent" value="package com.example.tuchanguito.ui.screens.lists&#10;&#10;import androidx.compose.foundation.clickable&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.unit.dp&#10;import com.example.tuchanguito.data.AppRepository&#10;import kotlinx.coroutines.launch&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun ListsScreen(onOpenList: (Long) -&gt; Unit) {&#10;    val context = androidx.compose.ui.platform.LocalContext.current&#10;    val repo = remember { AppRepository.get(context) }&#10;    val lists by repo.activeLists().collectAsState(initial = emptyList())&#10;    val scope = rememberCoroutineScope()&#10;&#10;    Scaffold(topBar = { TopAppBar(title = { Text(&quot;Listas&quot;) }) }, floatingActionButton = {&#10;        FloatingActionButton(onClick = { scope.launch { val id = repo.createList(&quot;Supermercado - Hoy&quot;) ; onOpenList(id) } }) { Text(&quot;+&quot;) }&#10;    }) { padding -&gt;&#10;        Column(Modifier.fillMaxSize().padding(padding).padding(16.dp)) {&#10;            lists.forEach { list -&gt;&#10;                ListItem(headlineContent = { Text(list.title) }, modifier = Modifier.fillMaxWidth().clickable { onOpenList(list.id) })&#10;                Divider()&#10;            }&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.tuchanguito.ui.screens.lists&#10;&#10;import androidx.compose.foundation.clickable&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.platform.LocalConfiguration&#10;import android.content.res.Configuration&#10;import androidx.compose.foundation.rememberScrollState&#10;import androidx.compose.foundation.verticalScroll&#10;import androidx.compose.ui.unit.dp&#10;import com.example.tuchanguito.data.AppRepository&#10;import kotlinx.coroutines.launch&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun ListsScreen(onOpenList: (Long) -&gt; Unit) {&#10;    val context = androidx.compose.ui.platform.LocalContext.current&#10;    val repo = remember { AppRepository.get(context) }&#10;    val lists by repo.activeLists().collectAsState(initial = emptyList())&#10;    val scope = rememberCoroutineScope()&#10;&#10;    Scaffold(topBar = { TopAppBar(title = { Text(&quot;Listas&quot;) }) }, floatingActionButton = {&#10;        FloatingActionButton(onClick = { scope.launch { val id = repo.createList(&quot;Supermercado - Hoy&quot;) ; onOpenList(id) } }) { Text(&quot;+&quot;) }&#10;    }) { padding -&gt;&#10;        val isLandscape = LocalConfiguration.current.orientation == Configuration.ORIENTATION_LANDSCAPE&#10;        val scrollMod = if (isLandscape) Modifier.verticalScroll(rememberScrollState()) else Modifier&#10;        Column(Modifier.fillMaxSize().then(scrollMod).padding(padding).padding(16.dp)) {&#10;            lists.forEach { list -&gt;&#10;                ListItem(headlineContent = { Text(list.title) }, modifier = Modifier.fillMaxWidth().clickable { onOpenList(list.id) })&#10;                Divider()&#10;            }&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/tuchanguito/ui/screens/pantry/PantryScreen.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/tuchanguito/ui/screens/pantry/PantryScreen.kt" />
              <option name="originalContent" value="package com.example.tuchanguito.ui.screens.pantry&#10;&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.unit.dp&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun PantryScreen() {&#10;    Scaffold(topBar = { TopAppBar(title = { Text(&quot;Alacenas&quot;) }) }) { innerPadding -&gt;&#10;        Column(Modifier.padding(innerPadding)) {&#10;            Text(&quot;Gestionar productos en la despensa (RF15 opcional)&quot;, modifier = Modifier.padding(16.dp))&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.tuchanguito.ui.screens.pantry&#10;&#10;import android.content.res.Configuration&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.rememberScrollState&#10;import androidx.compose.foundation.verticalScroll&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.platform.LocalConfiguration&#10;import androidx.compose.ui.unit.dp&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun PantryScreen() {&#10;    Scaffold(topBar = { TopAppBar(title = { Text(&quot;Alacenas&quot;) }) }) { innerPadding -&gt;&#10;        val isLandscape = LocalConfiguration.current.orientation == Configuration.ORIENTATION_LANDSCAPE&#10;        val scrollMod = if (isLandscape) Modifier.verticalScroll(rememberScrollState()) else Modifier&#10;        Column(Modifier.then(scrollMod).padding(innerPadding)) {&#10;            Text(&quot;Gestionar productos en la despensa (RF15 opcional)&quot;, modifier = Modifier.padding(16.dp))&#10;        }&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/tuchanguito/ui/screens/profile/ProfileScreen.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/tuchanguito/ui/screens/profile/ProfileScreen.kt" />
              <option name="originalContent" value="package com.example.tuchanguito.ui.screens.profile&#10;&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.unit.dp&#10;import com.example.tuchanguito.data.AppRepository&#10;import com.example.tuchanguito.data.PreferencesManager&#10;import kotlinx.coroutines.launch&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun ProfileScreen(onChangePassword: () -&gt; Unit) {&#10;    val context = androidx.compose.ui.platform.LocalContext.current&#10;    val prefs = remember { PreferencesManager(context) }&#10;    val repo = remember { AppRepository.get(context) }&#10;    val scope = rememberCoroutineScope()&#10;&#10;    val theme by prefs.theme.collectAsState(initial = &quot;system&quot;)&#10;    val snackbarHostState = remember { SnackbarHostState() }&#10;    var showLogoutDialog by remember { mutableStateOf(false) }&#10;&#10;    var editMode by remember { mutableStateOf(false) }&#10;    var name by remember { mutableStateOf(&quot;&quot;) }&#10;    var surname by remember { mutableStateOf&lt;String?&gt;(null) }&#10;    var loading by remember { mutableStateOf(false) }&#10;&#10;    LaunchedEffect(Unit) {&#10;        loading = true&#10;        repo.getProfile().onSuccess { user -&gt;&#10;            name = user.name&#10;            surname = user.surname&#10;        }.onFailure { snackbarHostState.showSnackbar(it.message ?: &quot;Error al cargar usuario&quot;) }&#10;        loading = false&#10;    }&#10;&#10;    Scaffold(topBar = { TopAppBar(title = { Text(&quot;Perfil&quot;) }) }, snackbarHost = { SnackbarHost(hostState = snackbarHostState) }) { padding -&gt;&#10;        Column(Modifier.fillMaxSize().padding(padding).padding(16.dp), verticalArrangement = Arrangement.spacedBy(12.dp)) {&#10;            // Profile info&#10;            Text(&quot;Datos de usuario&quot;, style = MaterialTheme.typography.titleMedium)&#10;            if (loading) { CircularProgressIndicator() }&#10;            else {&#10;                if (!editMode) {&#10;                    Text(&quot;Nombre: ${name}&quot;)&#10;                    Text(&quot;Apellido: ${surname ?: &quot;&quot;}&quot;)&#10;                    Row(horizontalArrangement = Arrangement.spacedBy(8.dp)) {&#10;                        Button(onClick = { editMode = true }) { Text(&quot;Editar perfil&quot;) }&#10;                        Button(onClick = { onChangePassword() }) { Text(&quot;Cambiar contraseña&quot;) }&#10;                    }&#10;                } else {&#10;                    OutlinedTextField(value = name, onValueChange = { name = it }, label = { Text(&quot;Nombre&quot;) }, modifier = Modifier.fillMaxWidth())&#10;                    Spacer(Modifier.height(8.dp))&#10;                    OutlinedTextField(value = surname ?: &quot;&quot;, onValueChange = { surname = it }, label = { Text(&quot;Apellido&quot;) }, modifier = Modifier.fillMaxWidth())&#10;                    Row(horizontalArrangement = Arrangement.spacedBy(8.dp)) {&#10;                        Button(onClick = {&#10;                            // Save&#10;                            scope.launch {&#10;                                loading = true&#10;                                repo.updateProfile(name.takeIf { it.isNotBlank() }, surname?.takeIf { it.isNotBlank() }).onSuccess {&#10;                                    snackbarHostState.showSnackbar(&quot;Perfil actualizado&quot;)&#10;                                    editMode = false&#10;                                }.onFailure { snackbarHostState.showSnackbar(it.message ?: &quot;Error al guardar&quot;) }&#10;                                loading = false&#10;                            }&#10;                        }) { Text(&quot;Guardar cambios&quot;) }&#10;                        TextButton(onClick = { editMode = false }) { Text(&quot;Cancelar&quot;) }&#10;                    }&#10;                }&#10;            }&#10;&#10;            Divider()&#10;&#10;            Text(&quot;Personalización&quot;)&#10;            Row(verticalAlignment = Alignment.CenterVertically, horizontalArrangement = Arrangement.spacedBy(12.dp)) {&#10;                Text(&quot;Tema claro&quot;)&#10;                // Observe the stored theme directly; toggle between light/dark&#10;                Switch(checked = theme == &quot;light&quot;, onCheckedChange = { checked -&gt;&#10;                    scope.launch { prefs.setTheme(if (checked) &quot;light&quot; else &quot;dark&quot;) }&#10;                })&#10;            }&#10;&#10;            // Moneda field removed per request&#10;            Spacer(Modifier.height(8.dp))&#10;            val contextText = &quot;Cerrar sesión&quot;&#10;            Button(onClick = { showLogoutDialog = true }) { Text(contextText) }&#10;        }&#10;    }&#10;&#10;    if (showLogoutDialog) {&#10;        AlertDialog(&#10;            onDismissRequest = { showLogoutDialog = false },&#10;            title = { Text(&quot;Cerrar sesión&quot;) },&#10;            text = { Text(&quot;¿Estás seguro que querés cerrar la sesión?&quot;) },&#10;            confirmButton = {&#10;                TextButton(onClick = {&#10;                    scope.launch {&#10;                        prefs.setAuthToken(null)&#10;                        prefs.setCurrentUserId(null)&#10;                        snackbarHostState.showSnackbar(&quot;Sesión cerrada&quot;)&#10;                    }&#10;                    showLogoutDialog = false&#10;                }) { Text(&quot;Sí&quot;) }&#10;            },&#10;            dismissButton = { TextButton(onClick = { showLogoutDialog = false }) { Text(&quot;No&quot;) } }&#10;        )&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.tuchanguito.ui.screens.profile&#10;&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.platform.LocalConfiguration&#10;import androidx.compose.ui.unit.dp&#10;import com.example.tuchanguito.data.AppRepository&#10;import com.example.tuchanguito.data.PreferencesManager&#10;import kotlinx.coroutines.launch&#10;import android.content.res.Configuration&#10;import androidx.compose.foundation.rememberScrollState&#10;import androidx.compose.foundation.verticalScroll&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun ProfileScreen(onChangePassword: () -&gt; Unit) {&#10;    val context = androidx.compose.ui.platform.LocalContext.current&#10;    val prefs = remember { PreferencesManager(context) }&#10;    val repo = remember { AppRepository.get(context) }&#10;    val scope = rememberCoroutineScope()&#10;&#10;    val theme by prefs.theme.collectAsState(initial = &quot;system&quot;)&#10;    val snackbarHostState = remember { SnackbarHostState() }&#10;    var showLogoutDialog by remember { mutableStateOf(false) }&#10;&#10;    var editMode by remember { mutableStateOf(false) }&#10;    var name by remember { mutableStateOf(&quot;&quot;) }&#10;    var surname by remember { mutableStateOf&lt;String?&gt;(null) }&#10;    var loading by remember { mutableStateOf(false) }&#10;&#10;    LaunchedEffect(Unit) {&#10;        loading = true&#10;        repo.getProfile().onSuccess { user -&gt;&#10;            name = user.name&#10;            surname = user.surname&#10;        }.onFailure { snackbarHostState.showSnackbar(it.message ?: &quot;Error al cargar usuario&quot;) }&#10;        loading = false&#10;    }&#10;&#10;    Scaffold(topBar = { TopAppBar(title = { Text(&quot;Perfil&quot;) }) }, snackbarHost = { SnackbarHost(hostState = snackbarHostState) }) { padding -&gt;&#10;        val isLandscape = LocalConfiguration.current.orientation == Configuration.ORIENTATION_LANDSCAPE&#10;        val scrollMod = if (isLandscape) Modifier.verticalScroll(rememberScrollState()) else Modifier&#10;        Column(Modifier.fillMaxSize().then(scrollMod).padding(padding).padding(16.dp), verticalArrangement = Arrangement.spacedBy(12.dp)) {&#10;            // Profile info&#10;            Text(&quot;Datos de usuario&quot;, style = MaterialTheme.typography.titleMedium)&#10;            if (loading) { CircularProgressIndicator() }&#10;            else {&#10;                if (!editMode) {&#10;                    Text(&quot;Nombre: ${name}&quot;)&#10;                    Text(&quot;Apellido: ${surname ?: &quot;&quot;}&quot;)&#10;                    Row(horizontalArrangement = Arrangement.spacedBy(8.dp)) {&#10;                        Button(onClick = { editMode = true }) { Text(&quot;Editar perfil&quot;) }&#10;                        Button(onClick = { onChangePassword() }) { Text(&quot;Cambiar contraseña&quot;) }&#10;                    }&#10;                } else {&#10;                    OutlinedTextField(value = name, onValueChange = { name = it }, label = { Text(&quot;Nombre&quot;) }, modifier = Modifier.fillMaxWidth())&#10;                    Spacer(Modifier.height(8.dp))&#10;                    OutlinedTextField(value = surname ?: &quot;&quot;, onValueChange = { surname = it }, label = { Text(&quot;Apellido&quot;) }, modifier = Modifier.fillMaxWidth())&#10;                    Row(horizontalArrangement = Arrangement.spacedBy(8.dp)) {&#10;                        Button(onClick = {&#10;                            // Save&#10;                            scope.launch {&#10;                                loading = true&#10;                                repo.updateProfile(name.takeIf { it.isNotBlank() }, surname?.takeIf { it.isNotBlank() }).onSuccess {&#10;                                    snackbarHostState.showSnackbar(&quot;Perfil actualizado&quot;)&#10;                                    editMode = false&#10;                                }.onFailure { snackbarHostState.showSnackbar(it.message ?: &quot;Error al guardar&quot;) }&#10;                                loading = false&#10;                            }&#10;                        }) { Text(&quot;Guardar cambios&quot;) }&#10;                        TextButton(onClick = { editMode = false }) { Text(&quot;Cancelar&quot;) }&#10;                    }&#10;                }&#10;            }&#10;&#10;            Divider()&#10;&#10;            Text(&quot;Personalización&quot;)&#10;            Row(verticalAlignment = Alignment.CenterVertically, horizontalArrangement = Arrangement.spacedBy(12.dp)) {&#10;                Text(&quot;Tema claro&quot;)&#10;                // Observe the stored theme directly; toggle between light/dark&#10;                Switch(checked = theme == &quot;light&quot;, onCheckedChange = { checked -&gt;&#10;                    scope.launch { prefs.setTheme(if (checked) &quot;light&quot; else &quot;dark&quot;) }&#10;                })&#10;            }&#10;&#10;            // Moneda field removed per request&#10;            Spacer(Modifier.height(8.dp))&#10;            val contextText = &quot;Cerrar sesión&quot;&#10;            Button(onClick = { showLogoutDialog = true }) { Text(contextText) }&#10;        }&#10;    }&#10;&#10;    if (showLogoutDialog) {&#10;        AlertDialog(&#10;            onDismissRequest = { showLogoutDialog = false },&#10;            title = { Text(&quot;Cerrar sesión&quot;) },&#10;            text = { Text(&quot;¿Estás seguro que querés cerrar la sesión?&quot;) },&#10;            confirmButton = {&#10;                TextButton(onClick = {&#10;                    scope.launch {&#10;                        prefs.setAuthToken(null)&#10;                        prefs.setCurrentUserId(null)&#10;                        snackbarHostState.showSnackbar(&quot;Sesión cerrada&quot;)&#10;                    }&#10;                    showLogoutDialog = false&#10;                }) { Text(&quot;Sí&quot;) }&#10;            },&#10;            dismissButton = { TextButton(onClick = { showLogoutDialog = false }) { Text(&quot;No&quot;) } }&#10;        )&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>